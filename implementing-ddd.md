# Implementing Domain-Driven Design
by Vaughn Vernon

- [Chapter 1 Getting Started with DDD](#chapter-1-getting-started-with-ddd)
- [Chapter 2 Domains, Subdomains, and Bounded Contexts](#chapter-2-domains-subdomains-and-bounded-contexts)
- [Chapter 3 Context Maps](#chapter-3-context-maps)
- [Chapter 4 Architecture](#chapter-4-architecture)
- [Chapter 5 Entities](#chapter-5-entities)
- [Chapter 6 Value Objects](#chapter-6-value-objects)


## Chapter 1 Getting Started with DDD
> TODO
## Chapter 2 Domains, Subdomains, and Bounded Contexts
There are three things you are going to have to understand very clearly:
- What your Domain is
- What your Subdomains are
- What your Bounded Contexts are

### Big Picture
A Domain is what an organization does, and the world it does it in. Each organization has **its own unique realm of know-how** and way of doing things.
That realm of understanding is its **Domain**.

#### Subdomains and Bounded Contexts at Work
#### Focus on the Core Domain

### Why Strategic Design Is So Incredibly Essential
> TODO

## Chapter 3 Context Maps
> TODO

## Chapter 4 Architecture
> TODO
## Chapter 5 Entities

Instead of designing domain concepts with rich behaviors, we might think primarily about the attributes (columns) and 
associations (foreign keys) of the data.

### Why We Use Entities
An Entity is a unique thing and is capable of being changed continuously.
- Care about its individuality.
- Distinguishing it from all other objects in a system is a mandatory constraint.

Its state changes can be tracked or not, depending on our needs.

DDD is not always the best fit. If a concept can be modeled as a Value, maybe it is better to use a CRUD-based solution. 

### Unique Identity

>"Rather than focusing on the attributes or even the behavior, strip the Entity object’s definition down to the most 
> intrinsic characteristics, particularly those that identify it or are commonly used to find or match it. Add only 
> behavior that is essential to the concept and attributes that are required by that behavior."

An Entity’s unique identity may or may not also be practical for finding or matching. It will depend on wether it is 
human-readable or not.

Value Objects can serve as holders of unique identity because they are immutable.

Common strategies for identity creation:
- The user provides one or more original unique values as input.
- The application internally generates an identity
- The application relies on a persistence store
- Another Bounded Context has already determined the unique identity.

#### User Provides Identity

A user manually enter the details of unique identity.
Complications:
- Identity may be unique but incorrect, and it is supposed to be immutable.
- To prevent this problem, design discussions arise.
- Work- flow-based identity approval not high-throughput.

It is better to support user-entered values as properties that can change and be used for matching and use another 
approach for identity.

#### Application Generates Identity

Highly reliables ways to auto generate unique identities (UUID or GUID).
UUID is fast enough to produce several unique identities per second, and if not fast enough, pre-generated identities 
can be cached.

Semi random human-readable identities can be generated by concatenating different values such as a date, an app name, 
or a project name with part of a UUID to uniquely identify it from other entities with same values.

#### Persistence Mechanism Generates Identity

Sequence or incrementing value will always be unique.
One possible downside is performance, it takes longer to get it from db than from the app.
Caching can be an improvement, but it has the downside that some identities can be lost. Recovering the lost ones isn't 
worth it.

Late identity can be the solution but again, it has one problem, that is the timing of the generation.

#### Another Bounded Context Assigns Identity

Sometimes it involves some kind of search based on partial info and human interaction to select the exact Entity.

¿¿¿The identity of the selected choice is used as the local identity.???

In order to be up to date with the external Entity changes, an Event-Driven Architecture with Domain Events can be used.
Complicated but provides autonomy to the systems. It is not a matter of importing foreign objects but translating them 
to the local Bounded Context.

#### When the Timing of Identity Generation Matters

Identity generation can occur before or after the Entity's construction.

If it is generated late, when persisted, the application can generate domain events without the correct identity.
Also, when two or more new Entities must be unique within a collection (Set), no matter the rest of the values, as the 
identity is "empty", the objects would be the same. To solve this problem, either the design is changed to generate the 
identity earlier, or the _equals_ method works on attributes, and the Entity becomes a Value Object.

#### Surrogate Identity
We are force to use a surrogate identity when the ORM (such as Hibernate) requires some specific format (numeric) 
different from the domain one. It is necessary to create an attribute in the Entity and a column in the table.
It is important to hide the surrogate identity from the outside because is not part of the domain model.

A possible safeguard can be to use a _Layer_ _Supertype_, an abstract base class that hides the surrogate primary key.

There is no need for the domain identity to play the role of database pri- mary key.

#### Identity Stability
The identity of an entity must be immutable during its lifetime.
It can be achieved by hiding the setter methods and by adding guard clauses to avoid assigning invalid values (null),
even to the entity itself.

## Chapter 6 Value Objects

Value Objects are a vital building block of DDD.

> **Know the Value Advantages**
>
> Value types that measure, quantify, or describe things are easier to create, test, use, optimize, and maintain.

To determine if a domain concept should be modeled as a Value, we have to pay close attention to its characteristics:

### Value Characteristics

#### Measures, Quantifies, or Describes
A concept that measures, quantifies, or otherwise describes a thing in the domain.

#### Immutable
A Value is unchangeable after it has been created.

#### Conceptual Whole
A Value Object may possess just one, a few, or a number of individual attributes, each of which is related to the others.

#### Replaceability
The entire Value is completely replaced with a new Value that does represent the currently correct whole when 

#### Value Equality
Equality is determined by comparing the types of both objects and then their attributes.

#### Side-Effect-Free Behavior
A _function_ is an operation of an object that produces output but without modifying its own state.
Query some info or return a new instance of the value object with the previous state plus the new or modified content.

### Integrate with Minimalism
We must find appropriate ways to integrate multiple Bounded Contexts.

> Where possible use Value Objects to model concepts in the downstream Context when objects from the upstream Context
> flow in.



### Standard Types Expressed as Values
### Testing Value Objects
### Implementation
### Persisting Value Objects
